{"ast":null,"code":"import _slicedToArray from\"/Users/duyennguyen/STREAMING/amazon-ivs-virtual-qa-web-demo/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React from'react';import IVSContext from'../providers/IVSContext';import PlayerMetadataContext from'../providers/PlayerMetadataContext';import CurrentQuestion from'./CurrentQuestion';import{SET_CURRENT_QUESTION_ACTION}from'../providers/PlayerMetadataProvider';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function Player(){var _React$useContext=React.useContext(IVSContext),playbackUrl=_React$useContext.playbackUrl;var _React$useContext2=React.useContext(PlayerMetadataContext),_React$useContext3=_slicedToArray(_React$useContext2,2),dispatch=_React$useContext3[1];React.useEffect(function(){// eslint-disable-next-line no-undef\nvar videojs=window.videojs,registerIVSTech=window.registerIVSTech,registerIVSQualityPlugin=window.registerIVSQualityPlugin;// Set up IVS playback tech and quality plugin\nvar IVSPlugin=videojs.getPlugin(\"getIVSPlayer\");// If the plugins haven't been loaded, load them.\nif(!IVSPlugin){registerIVSTech(videojs);registerIVSQualityPlugin(videojs);}var videoJsOptions={techOrder:[\"AmazonIVS\"],autoplay:true,muted:true};// instantiate video.js\nvar player=videojs(\"amazon-ivs-videojs\",videoJsOptions);var ivsPlayer=player.getIVSPlayer();var PlayerEventType=player.getIVSEvents().PlayerEventType;ivsPlayer.addEventListener(PlayerEventType.TEXT_METADATA_CUE,function(cue){var metadataText=cue.text;console.log('Timed metadata: ',metadataText);dispatch({type:SET_CURRENT_QUESTION_ACTION,question:JSON.parse(metadataText)});});player.ready(function(){player.enableIVSQualityPlugin();player.src(playbackUrl);player.play();});return function(){player.dispose();};// eslint-disable-next-line\n},[]);return/*#__PURE__*/_jsxs(\"div\",{className:\"player-wrapper\",children:[/*#__PURE__*/_jsx(CurrentQuestion,{}),/*#__PURE__*/_jsx(\"div\",{\"data-vjs-player\":true,children:/*#__PURE__*/_jsx(\"video\",{id:\"amazon-ivs-videojs\",className:\"video-js vjs-fluid\",playsInline:true})})]});}export default Player;","map":{"version":3,"sources":["/Users/duyennguyen/STREAMING/amazon-ivs-virtual-qa-web-demo/frontend/src/player/Player.js"],"names":["React","IVSContext","PlayerMetadataContext","CurrentQuestion","SET_CURRENT_QUESTION_ACTION","Player","useContext","playbackUrl","dispatch","useEffect","videojs","window","registerIVSTech","registerIVSQualityPlugin","IVSPlugin","getPlugin","videoJsOptions","techOrder","autoplay","muted","player","ivsPlayer","getIVSPlayer","PlayerEventType","getIVSEvents","addEventListener","TEXT_METADATA_CUE","cue","metadataText","text","console","log","type","question","JSON","parse","ready","enableIVSQualityPlugin","src","play","dispose"],"mappings":"2LAAA,MAAOA,CAAAA,KAAP,KAAkB,OAAlB,CACA,MAAOC,CAAAA,UAAP,KAAuB,yBAAvB,CACA,MAAOC,CAAAA,qBAAP,KAAkC,oCAAlC,CACA,MAAOC,CAAAA,eAAP,KAA4B,mBAA5B,CACA,OAASC,2BAAT,KAA4C,qCAA5C,C,wFAEA,QAASC,CAAAA,MAAT,EAAkB,CACd,sBAAwBL,KAAK,CAACM,UAAN,CAAiBL,UAAjB,CAAxB,CAAQM,WAAR,mBAAQA,WAAR,CACA,uBAAqBP,KAAK,CAACM,UAAN,CAAiBJ,qBAAjB,CAArB,yDAASM,QAAT,uBAEAR,KAAK,CAACS,SAAN,CAAgB,UAAM,CAClB;AACA,GAAMC,CAAAA,OAAO,CAAGC,MAAM,CAACD,OAAvB,CACME,eAAe,CAAGD,MAAM,CAACC,eAD/B,CAEMC,wBAAwB,CAAGF,MAAM,CAACE,wBAFxC,CAIA;AACA,GAAMC,CAAAA,SAAS,CAAGJ,OAAO,CAACK,SAAR,CAAkB,cAAlB,CAAlB,CAEA;AACA,GAAI,CAACD,SAAL,CAAgB,CACdF,eAAe,CAACF,OAAD,CAAf,CACAG,wBAAwB,CAACH,OAAD,CAAxB,CACD,CAED,GAAMM,CAAAA,cAAc,CAAG,CACrBC,SAAS,CAAE,CAAC,WAAD,CADU,CAErBC,QAAQ,CAAE,IAFW,CAGrBC,KAAK,CAAE,IAHc,CAAvB,CAMA;AACA,GAAMC,CAAAA,MAAM,CAAGV,OAAO,CAAC,oBAAD,CAAuBM,cAAvB,CAAtB,CACA,GAAMK,CAAAA,SAAS,CAAGD,MAAM,CAACE,YAAP,EAAlB,CACA,GAAMC,CAAAA,eAAe,CAAGH,MAAM,CAACI,YAAP,GAAsBD,eAA9C,CAEAF,SAAS,CAACI,gBAAV,CAA2BF,eAAe,CAACG,iBAA3C,CAA8D,SAACC,GAAD,CAAS,CACnE,GAAMC,CAAAA,YAAY,CAAGD,GAAG,CAACE,IAAzB,CACAC,OAAO,CAACC,GAAR,CAAY,kBAAZ,CAAgCH,YAAhC,EACApB,QAAQ,CAAC,CACLwB,IAAI,CAAE5B,2BADD,CAEL6B,QAAQ,CAAEC,IAAI,CAACC,KAAL,CAAWP,YAAX,CAFL,CAAD,CAAR,CAIH,CAPD,EASAR,MAAM,CAACgB,KAAP,CAAa,UAAM,CACjBhB,MAAM,CAACiB,sBAAP,GACAjB,MAAM,CAACkB,GAAP,CAAW/B,WAAX,EACAa,MAAM,CAACmB,IAAP,GACD,CAJD,EAMA,MAAO,WAAM,CACTnB,MAAM,CAACoB,OAAP,GACH,CAFD,CAGA;AACH,CA7CD,CA6CG,EA7CH,EA+CA,mBACI,aAAK,SAAS,CAAC,gBAAf,wBACI,KAAC,eAAD,IADJ,cAEI,YAAK,sBAAL,uBACI,cAAO,EAAE,CAAC,oBAAV,CAA+B,SAAS,CAAC,oBAAzC,CAA8D,WAAW,KAAzE,EADJ,EAFJ,GADJ,CAQD,CAEH,cAAenC,CAAAA,MAAf","sourcesContent":["import React from 'react';\nimport IVSContext from '../providers/IVSContext';\nimport PlayerMetadataContext from '../providers/PlayerMetadataContext';\nimport CurrentQuestion from './CurrentQuestion';\nimport { SET_CURRENT_QUESTION_ACTION } from '../providers/PlayerMetadataProvider';\n\nfunction Player() {\n    const { playbackUrl } = React.useContext(IVSContext);\n    const [, dispatch] = React.useContext(PlayerMetadataContext);\n\n    React.useEffect(() => {\n        // eslint-disable-next-line no-undef\n        const videojs = window.videojs,\n              registerIVSTech = window.registerIVSTech,\n              registerIVSQualityPlugin = window.registerIVSQualityPlugin;\n\n        // Set up IVS playback tech and quality plugin\n        const IVSPlugin = videojs.getPlugin(\"getIVSPlayer\");\n\n        // If the plugins haven't been loaded, load them.\n        if (!IVSPlugin) {\n          registerIVSTech(videojs);\n          registerIVSQualityPlugin(videojs);\n        }\n\n        const videoJsOptions = {\n          techOrder: [\"AmazonIVS\"],\n          autoplay: true,\n          muted: true,\n        };\n\n        // instantiate video.js\n        const player = videojs(\"amazon-ivs-videojs\", videoJsOptions);\n        const ivsPlayer = player.getIVSPlayer();\n        const PlayerEventType = player.getIVSEvents().PlayerEventType;\n\n        ivsPlayer.addEventListener(PlayerEventType.TEXT_METADATA_CUE, (cue) => {\n            const metadataText = cue.text;\n            console.log('Timed metadata: ', metadataText);\n            dispatch({\n                type: SET_CURRENT_QUESTION_ACTION,\n                question: JSON.parse(metadataText),\n            });\n        });\n\n        player.ready(() => {\n          player.enableIVSQualityPlugin();\n          player.src(playbackUrl);\n          player.play();\n        });\n\n        return () => {\n            player.dispose();\n        };\n        // eslint-disable-next-line\n    }, []);\n\n    return (\n        <div className=\"player-wrapper\">\n            <CurrentQuestion />\n            <div data-vjs-player>\n                <video id=\"amazon-ivs-videojs\" className=\"video-js vjs-fluid\" playsInline />\n            </div>\n        </div>\n    );\n  }\n\nexport default Player;\n"]},"metadata":{},"sourceType":"module"}